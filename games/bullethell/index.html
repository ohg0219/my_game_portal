<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>ğŸš€ íƒ„ë§‰ ìŠˆíŒ… ê²Œì„</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="../../" class="back-button">ğŸ  ê²Œì„ ëª©ë¡ìœ¼ë¡œ</a>
            <h1>íƒ„ë§‰ ìŠˆíŒ…</h1>
        </div>

        <div id="instructions">
            <h2>ê²Œì„ ë°©ë²•</h2>
            <p><strong>PC:</strong> WASD ë˜ëŠ” ë°©í–¥í‚¤ë¡œ ì´ë™</p>
            <p><strong>ëª¨ë°”ì¼:</strong> í™”ë©´ì˜ ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì—¬ ì´ë™</p>
            <p>ë¯¸ì‚¬ì¼ì€ ìë™ìœ¼ë¡œ ë°œì‚¬ë©ë‹ˆë‹¤.</p>
            <button id="start-game-btn">ê²Œì„ ì‹œì‘</button>
        </div>

        <div class="game-container">
            <canvas id="game-canvas"></canvas>
            <div class="game-over-overlay" id="game-over-overlay">
                <h2>ê²Œì„ ì˜¤ë²„</h2>
                <p>ìµœì¢… ì ìˆ˜: <span id="final-score">0</span></p>
                <button id="restart-btn">ë‹¤ì‹œ ì‹œì‘</button>
            </div>
        </div>

        <div class="mobile-controls">
            <div class="d-pad">
                <button class="control-btn" data-direction="w">â†‘</button>
                <button class="control-btn" data-direction="a">â†</button>
                <button class="control-btn" data-direction="s">â†“</button>
                <button class="control-btn" data-direction="d">â†’</button>
            </div>
        </div>
    </div>

    <!-- Correct Script Loading Order -->
    <script src="lib/utils.js"></script>
    <script src="lib/movingObject.js"></script>
    <script src="lib/bullet.js"></script>
    <script src="lib/enemyBullet.js"></script>
    <script src="lib/enemyObject.js"></script>
    <script src="lib/enemyUFO.js"></script>
    <script src="lib/enemySatellite.js"></script>
    <script src="lib/enemyBoss.js"></script>
    <script src="lib/item.js"></script>
    <script src="lib/ship.js"></script>
    <script src="lib/game.js"></script>
    <script src="gameView.js"></script>

    <script>
      window.BHGame.config = {};

      window.onload = function () {
        const canvas = document.getElementById('game-canvas');
        const instructions = document.getElementById('instructions');
        const startBtn = document.getElementById('start-game-btn');
        const restartBtn = document.getElementById('restart-btn');
        const gameContainer = document.querySelector('.game-container');
        const gameOverOverlay = document.getElementById('game-over-overlay');

        let gameView;

        function setupCanvas() {
            const containerWidth = gameContainer.offsetWidth;
            const isMobile = window.innerWidth < 768;

            canvas.width = Math.min(containerWidth, 800);

            if (isMobile) {
                // Taller aspect ratio for mobile
                canvas.height = window.innerHeight * 0.7;
            } else {
                // Wider aspect ratio for desktop
                canvas.height = canvas.width * 0.75;
            }

            BHGame.Game.DIM_X = canvas.width;
            BHGame.Game.DIM_Y = canvas.height;

            // Set scale factor for responsive sizing
            BHGame.config.scale = isMobile ? 0.7 : 1.0;
            BHGame.config.baseSpeed = 1.0;
            BHGame.config.enemySpeedMultiplier = isMobile ? 0.7 : 1.0;
        }

        function startGame() {
            instructions.style.display = 'none';
            gameOverOverlay.style.display = 'none';
            gameContainer.style.display = 'block';

            setupCanvas();

            const ctx = canvas.getContext('2d');
            const game = new BHGame.Game();
            gameView = new BHGame.GameView(game, ctx);
            gameView.start();
        }

        startBtn.onclick = startGame;
        restartBtn.onclick = startGame;

        // Initially hide the game canvas and overlay
        gameContainer.style.display = 'none';
        gameOverOverlay.style.display = 'none';
      }
    </script>
</body>
</html>
